# Lecture 12. Query Execution II

## 并行与分布式 Parallel vs. Distributed

无论是并行DBMS还是分布式DBMS，都应该对应用程序表现为如同单一的DBMS一样

- **Parallel DBMSs**：资源的存储在物理上更靠近，相互之间采用高速连接，因此资源之间的通信成本低且可靠（例如都在同一数据中心）
- **Distributed DBMSs**：资源分布较远，采用一般（想对低速）的连接，因此资源之间的通信成本较高且可能出现故障（例如地理上分布的数据库）

## 查询的处理模型 Process Models

一个Worker定义为DBMS内代表client处理查询的组件

### 1. 每个Worker一个进程 Process per DBMS Worker

- 依赖操作系统的调度 OS scheduler
- 使用共享内存进行进程通信，实现跨进程的数据结构
- 单个进程宕机不会影响整个DBMS
- 例如：IBM DB2, Postgres, Oracle

![13.1](images/13.1.png)

### 2. 进程池 Process Pool

- 同样依赖操作系统调度和共享内存
- Worker绑定到进程池中的任意空闲的的进程
- 对CPU**缓存局部性不友好**
- 例如：IBM DB2

![13.2](images/13.2.png)

### 3. 每个Worker一个线程 Thread per DMBS Worker

- DBMS自身负责线程任务调度
- 不一定需要dispatcher线程
- 线程宕机会导致整个DBMS宕机
- 例如：IBM DB2, MSSQL, MySQL

![13.3](images/13.3.png)

**采用多线程模型已经是现在的主流做法**，上下文切换代价更小、无需管理共享内存、DBMS对任务的调度通常更好（操作系统无法针对数据库任务的负载做特殊处理）

## 执行的并行度 Execution Parallelism

## I/O的并行度 I/O Parallelism
